"use strict";var f=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var B=Object.prototype.hasOwnProperty;var D=(r,o)=>{for(var a in o)f(r,a,{get:o[a],enumerable:!0})},E=(r,o,a,p)=>{if(o&&typeof o=="object"||typeof o=="function")for(let i of x(o))!B.call(r,i)&&i!==a&&f(r,i,{get:()=>o[i],enumerable:!(p=v(o,i))||p.enumerable});return r};var F=r=>E(f({},"__esModule",{value:!0}),r);var R={};D(R,{default:()=>P});module.exports=F(R);var t=require("@raycast/api"),d=require("child_process"),c=require("react"),s=require("react/jsx-runtime");function P(){let[r,o]=(0,c.useState)([]),[a,p]=(0,c.useState)(void 0),i=t.preferences.shouldSearchInPaths?.value??!1,y=t.preferences.shouldPrioritizeAppsWhenFiltering?.value??!1,b=t.preferences.shouldShowPID?.value??!1,g=t.preferences.shouldShowPath?.value??!1,m=()=>{(0,d.exec)("ps -eo pid,pcpu,comm | sort -nrk 2,3",(e,n)=>{if(e!=null)return;let l=n.split(`
`).map(h=>{let[,A,$,u]=h.match(/(\d+)\s+(\d+[.|,]\d+)\s+(.*)/)??["","","",""],k=u.match(/[^/]*[^/]*$/i)?.[0]??"",L=u.includes(".prefPane"),T=u.includes(".app");return{id:A,cpu:$,path:u,name:k,type:L?"prefPane":T?"app":"binary"}}).filter(h=>h.name!=="");o(l)})};(0,c.useEffect)(()=>{m()},[]);let C=e=>e.type==="prefPane"?{fileIcon:e.path?.replace(/(.+\.prefPane)(.+)/,"$1")??""}:e.type==="app"?{fileIcon:e.path?.replace(/(.+\.app)(.+)/,"$1")??""}:"/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources/ExecutableBinaryIcon.icns",S=e=>{(0,d.exec)(`kill -9 ${e.id}`),o(r.filter(n=>n.id!==e.id)),(0,t.clearSearchBar)({forceScrollToTop:!0}),(0,t.showHUD)(`\u2705 Killed ${e.name==="-"?`process ${e.id}`:e.name}`)},w=e=>e.path==null?null:(0,s.jsx)(t.CopyToClipboardAction,{title:"Copy Path",content:e.path}),I=e=>{let n;return b&&(n=e.id),g&&(n=n?`${n} - ${e.path}`:e.path),n};return(0,s.jsx)(t.List,{isLoading:r.length===0,searchBarPlaceholder:"Filter by name...",onSearchTextChange:e=>p(e),children:r.filter(e=>{if(a==null)return!0;let n=e.name.toLowerCase().includes(a.toLowerCase()),l=e.path?.toLowerCase().match(new RegExp(`.+${a}.*\\.[app|framework|prefpane]`,"ig"))!=null;return n||i&&l}).sort((e,n)=>{if(a!=null&&y){if(e.type==="app"&&n.type!=="app")return-1;if(e.type!=="app"&&n.type==="app")return 1}return 0}).map((e,n)=>{let l=C(e);return(0,s.jsx)(t.List.Item,{title:e.name,subtitle:I(e),icon:l,accessoryTitle:`${e.cpu}%`,actions:(0,s.jsxs)(t.ActionPanel,{children:[(0,s.jsx)(t.ActionPanel.Item,{title:"Kill",icon:t.Icon.XmarkCircle,onAction:()=>S(e)}),w(e),(0,s.jsx)(t.ActionPanel.Item,{title:"Reload",icon:t.Icon.ArrowClockwise,shortcut:{key:"r",modifiers:["cmd"]},onAction:()=>m()})]})},n)})})}0&&(module.exports={});
