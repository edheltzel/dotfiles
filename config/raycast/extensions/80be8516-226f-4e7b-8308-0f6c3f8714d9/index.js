"use strict";var I=Object.create;var u=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var S=Object.getOwnPropertyNames;var b=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var A=(e,t)=>{for(var o in t)u(e,o,{get:t[o],enumerable:!0})},h=(e,t,o,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of S(t))!k.call(e,n)&&n!==o&&u(e,n,{get:()=>t[n],enumerable:!(s=T(t,n))||s.enumerable});return e};var f=(e,t,o)=>(o=e!=null?I(b(e)):{},h(t||!e||!e.__esModule?u(o,"default",{value:e,enumerable:!0}):o,e)),F=e=>h(u({},"__esModule",{value:!0}),e);var U={};A(U,{default:()=>C});module.exports=F(U);var c=require("react"),m=require("@raycast/api");var y=f(require("util")),P=f(require("child_process")),p=f(require("os")),l=require("@raycast/api"),v=y.default.promisify(P.default.exec);async function j(){switch(p.default.platform()){case"darwin":return M();default:throw new Error("Unsupported environment")}}async function M(){let e="ls /Volumes",t={timeout:0},o=[];try{let{stderr:s,stdout:n}=await v(e,t);o=B(n)}catch(s){console.log(s.message),(0,l.showToast)(l.ToastStyle.Failure,"Error listing volumes",s.message)}return o}function B(e){let t="~~~~~~~~~",o=e.replace(/\n/g,t),n=(0,l.getPreferenceValues)()?.ignoredVolumes?.split(","),r=o.split(t).map(i=>({name:i})).filter(i=>i.name!=="").filter(i=>!i.name.includes("TimeMachine.localsnapshots"));return n!=null&&(r=r.filter(i=>n.findIndex(E=>E===i.name)<0)),r}async function L(e){let t={timeout:0},o;switch(p.default.platform()){case"darwin":o='/usr/sbin/diskutil eject "'+e.name+'"';break;case"linux":o='eject -f "'+e.name+'"* 2>/dev/null || /bin/true';break;default:throw new Error("Unsupported environment")}try{let{stdout:s,stderr:n}=await v(o,t)}catch(s){console.log(s.message),(0,l.showToast)(l.ToastStyle.Failure,"Error ejecting volume",s.message)}}var a=require("@raycast/api"),d=require("react/jsx-runtime");function V(e){let{volume:t,eject:o}=e;return(0,d.jsx)(a.List.Item,{id:t.name,title:t.name,subtitle:"Select to eject",icon:"list-icon.png",actions:(0,d.jsx)(a.ActionPanel,{children:(0,d.jsx)(a.ActionPanel.Item,{title:"Eject Volume",onAction:()=>o(t)})})},t.name)}var x=require("react/jsx-runtime");function w(){let[e,t]=(0,c.useState)([]),[o,s]=(0,c.useState)(!0);async function n(){s(!0),t(await j()),s(!1)}async function g(r){let i=new m.Toast({style:m.ToastStyle.Animated,title:`Ejecting ${r.name}...`});await i.show(),await L(r),await i.hide(),(0,m.showToast)(m.ToastStyle.Success,`Successfully Ejected ${r.name}`),await n()}return(0,c.useEffect)(()=>{n()},[]),(0,x.jsx)(m.List,{isLoading:o,searchBarPlaceholder:"Filter Volumes By Name...",children:e.map(r=>(0,x.jsx)(V,{volume:r,eject:g},r.name))})}var C=w;0&&(module.exports={});
